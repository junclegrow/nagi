(defvar
    timeout 100
    macro-delay 10
)

(defcfg
    process-unmapped-keys yes
)

(defsrc
    q    w    e    r    t    y    u    i    o    p
    a    s    d    f    g    h    j    k    l    ;
    z    x    c    v    b    n    m    ,    .    /
    lshift spc rshift
)

(deflayer single
    (t! stroke q) (t! stroke w) (t! stroke e) (t! stroke r) up   down (t! stroke u) (t! stroke i) (t! stroke o) (t! stroke p)
    (t! stroke a) (t! stroke s) (t! stroke d) (t! stroke f) (t! stroke g) (t! stroke h) (t! stroke j) (t! stroke k) (t! stroke l) (t! stroke ;)
    (t! stroke z) (t! stroke x) (t! stroke c) (t! stroke v) (t! stroke b) (t! stroke n) (t! stroke m) (t! stroke ,) (t! stroke .) (t! stroke /)
    @ime-off @sands-nagi @ime-on
)

(deftemplate stroke (key) (fork (chord nagi $key) $key (lctrl rctrl lmeta rmeta lalt ralt lshift rshift)))

(defalias
    sands-nagi (tap-hold-press $timeout 500 spc (layer-while-held shifted))
    sands-qwerty (tap-hold-press $timeout 500 spc lshift)
    ime-off (tap-hold-press $timeout 500 (multi (arbitrary-code 26) (layer-switch qwerty)) lshift)
    ime-on (tap-hold-press $timeout 500 (multi (arbitrary-code 22) (layer-switch single)) rshift)
)

(deflayer shifted
    XX   ğŸ”£ã¬   ğŸ”£ã‚Š   ğŸ”£ã‚   XX   XX   ğŸ”£ã•   ğŸ”£ã‚ˆ   ğŸ”£ãˆ   ğŸ”£ã‚†
    ğŸ”£ã›   ğŸ”£ã¿   ğŸ”£ã«   ğŸ”£ã¾   ğŸ”£ã¡   ğŸ”£ã‚„   ğŸ”£ã®   ğŸ”£ã‚‚   ğŸ”£ã¤   ğŸ”£ãµ
    XX   XX   ğŸ”£ã‚’   (macro ğŸ”£ã€ ret) ğŸ”£ã‚€   ğŸ”£ãŠ   (macro ğŸ”£ã€‚ ret) ğŸ”£ã­   ğŸ”£ã‚   ğŸ”£ã‚Œ
    XX     XX  XX
)

(deflayer symbol-1
    (macro ğŸ”£â€») (macro ğŸ”£â˜…) (macro ğŸ”£â—†) ğŸ”£ãƒ»   ğŸ”£ã€‡   XX   XX   XX   XX   XX
    @3dot (macro ğŸ”£ï¼ˆ ret) (macro ğŸ”£ï¼Ÿ ret) (macro ğŸ”£ã€Œ ret) (macro ğŸ”£ã€ ret) XX   XX   XX   XX   XX
    @dash (macro ğŸ”£ï¼‰ ret) (macro ğŸ”£ï¼ ret) (macro ğŸ”£ã€ ret) (macro ğŸ”£ã€‘ ret) XX   XX   XX   XX   XX
    XX     XX  XX
)

(deflayer symbol-2  
    XX   XX   XX   XX   XX   XX   XX   XX   XX   XX
    (macro ğŸ”£ã€Š ret) (macro ğŸ”£ã€Š ret) (macro ğŸ”£ï¼Ÿ ret) (macro ğŸ”£ã€ ret) (macro ğŸ”£ã€Š ret) XX   XX   XX   XX   XX
    (macro ğŸ”£ã€‹ ret) (macro ğŸ”£ã€‹ ret) (macro ğŸ”£ï¼ ret) (macro ğŸ”£ã€ ret) (macro ğŸ”£ã€‹ ret) XX   XX   XX   XX   XX
    XX     XX  XX
)

(deflayer markdown
    (macro 1 . spc) (macro ğŸ”£> spc) (macro ğŸ”£* ğŸ”£* ) (macro - f8 spc) XX   XX   XX   XX   XX   XX
    XX   XX   @h3  @h2  XX   XX   XX   XX   XX   XX
    XX   XX   XX   XX   XX   XX   XX   XX   XX   XX
    XX     XX  XX
)

(defalias
    3dot (macro ğŸ”£â€¦ $macro-delay ğŸ”£â€¦)
    dash (macro ğŸ”£â€” $macro-delay ğŸ”£â€” ret)

    h2 (macro ğŸ”£# $macro-delay ğŸ”£# S-spc)
    h3 (macro ğŸ”£# $macro-delay ğŸ”£# $macro-delay ğŸ”£# S-spc)
)

(deflayer edit-1
    XX   XX   XX   XX   XX   XX   home up   end  XX
    lrld XX   XX   XX   XX   XX   left down right XX
    XX   XX   XX   XX   XX   XX   XX   XX   XX   XX
    XX     XX  XX
)

(deflayer edit-2
    XX   XX   XX   XX   XX   XX   (multi shft home) (multi shft up) (multi shft end) XX
    lrld XX   XX   XX   XX   XX   (multi shft left) (multi shft down) (multi shft right) XX
    XX   XX   XX   XX   XX   conv (multi shft ret) XX   XX   XX
    XX     XX  XX
)

(deflayer qwerty
    q    w    e    r    t    y    u    i    o    p
    a    s    d    f    g    h    j    k    l    ;
    z    x    c    v    b    n    m    ,    .    /
    @ime-off @sands-qwerty @ime-on
)

(defchords nagi $timeout
    (w) ğŸ”£ã
    (e) ğŸ”£ã¦
    (r) ğŸ”£ã—
    (u) bks
    (i) ğŸ”£ã‚‹
    (o) ğŸ”£ã™
    (p) ğŸ”£ã¸
    (a) ğŸ”£ã‚
    (s) ğŸ”£ã‘
    (d) ğŸ”£ã¨
    (f) ğŸ”£ã‹
    (g) ğŸ”£ã£
    (h) ğŸ”£ã
    (j) ğŸ”£ã‚
    (k) ğŸ”£ã„
    (l) ğŸ”£ã†
    (;) ğŸ”£ãƒ¼
    (z) ğŸ”£ã»
    (x) ğŸ”£ã²
    (c) ğŸ”£ã¯
    (v) ğŸ”£ã“
    (b) ğŸ”£ã
    (n) ğŸ”£ãŸ
    (m) ğŸ”£ãª
    (,) ğŸ”£ã‚“
    (.) ğŸ”£ã‚‰
    (/) ğŸ”£ã‚Œ

    (w j) ğŸ”£ã
    (e j) ğŸ”£ã§
    (r j) ğŸ”£ã˜
    (u f) ğŸ”£ã–
    (o f) ğŸ”£ãš
    (p f) ğŸ”£ã¹
    (a j) ğŸ”£ãœ
    (s j) ğŸ”£ã’
    (d j) ğŸ”£ã©
    (f j) ğŸ”£ãŒ
    (g j) ğŸ”£ã¢
    (h f) ğŸ”£ã
    (l f) ğŸ”£ã¥
    (; f) ğŸ”£ã¶
    (z j) ğŸ”£ã¼
    (x j) ğŸ”£ã³
    (c j) ğŸ”£ã°
    (v j) ğŸ”£ã”
    (b j) ğŸ”£ã
    (n f) ğŸ”£ã 

    (w h) (macro ğŸ”£ã ğŸ”£ã‚ƒ)
    (e h) (macro ğŸ”£ã‚Š ğŸ”£ã‚ƒ)
    (r h) (macro ğŸ”£ã— ğŸ”£ã‚ƒ)
    (s h) (macro ğŸ”£ã¿ ğŸ”£ã‚ƒ)
    (d h) (macro ğŸ”£ã« ğŸ”£ã‚ƒ)
    (g h) (macro ğŸ”£ã¡ ğŸ”£ã‚ƒ)
    (x h) (macro ğŸ”£ã² ğŸ”£ã‚ƒ)

    (w p) (macro ğŸ”£ã ğŸ”£ã‚…)
    (e p) (macro ğŸ”£ã‚Š ğŸ”£ã‚…)
    (r p) (macro ğŸ”£ã— ğŸ”£ã‚…)
    (s p) (macro ğŸ”£ã¿ ğŸ”£ã‚…)
    (d p) (macro ğŸ”£ã« ğŸ”£ã‚…)
    (g p) (macro ğŸ”£ã¡ ğŸ”£ã‚…)
    (x p) (macro ğŸ”£ã² ğŸ”£ã‚…)

    (w i) (macro ğŸ”£ã ğŸ”£ã‚‡)
    (e i) (macro ğŸ”£ã‚Š ğŸ”£ã‚‡)
    (r i) (macro ğŸ”£ã— ğŸ”£ã‚‡)
    (s i) (macro ğŸ”£ã¿ ğŸ”£ã‚‡)
    (d i) (macro ğŸ”£ã« ğŸ”£ã‚‡)
    (g i) (macro ğŸ”£ã¡ ğŸ”£ã‚‡)
    (x i) (macro ğŸ”£ã² ğŸ”£ã‚‡)

    (w h j) (macro ğŸ”£ã ğŸ”£ã‚ƒ)
    (r h j) (macro ğŸ”£ã˜ ğŸ”£ã‚ƒ)
    (g h j) (macro ğŸ”£ã¢ ğŸ”£ã‚ƒ)
    (x h j) (macro ğŸ”£ã³ ğŸ”£ã‚ƒ)

    (w p j) (macro ğŸ”£ã ğŸ”£ã‚…)
    (r p j) (macro ğŸ”£ã˜ ğŸ”£ã‚…)
    (g p j) (macro ğŸ”£ã¢ ğŸ”£ã‚…)
    (x p j) (macro ğŸ”£ã³ ğŸ”£ã‚…)

    (w i j) (macro ğŸ”£ã ğŸ”£ã‚‡)
    (r i j) (macro ğŸ”£ã˜ ğŸ”£ã‚‡)
    (g i j) (macro ğŸ”£ã¢ ğŸ”£ã‚‡)
    (x i j) (macro ğŸ”£ã³ ğŸ”£ã‚‡)

    (z m) ğŸ”£ã½
    (x m) ğŸ”£ã´
    (c m) ğŸ”£ã±
    (p v) ğŸ”£ãº
    (; v) ğŸ”£ã·
    
    (x m h) (macro ğŸ”£ã´ ğŸ”£ã‚ƒ)
    (x m p) (macro ğŸ”£ã´ ğŸ”£ã‚…)
    (x m i) (macro ğŸ”£ã´ ğŸ”£ã‚‡)

    (q j) ğŸ”£ã
    (q k) ğŸ”£ãƒ
    (q l) ğŸ”£ã…
    (q o) ğŸ”£ã‡
    (q n) ğŸ”£ã‰
    (q h) ğŸ”£ã‚ƒ
    (q p) ğŸ”£ã‚…
    (q i) ğŸ”£ã‚‡
    (q .) ğŸ”£ã‚

    (e m k) (macro ğŸ”£ã¦ ğŸ”£ãƒ)
    (e j k) (macro ğŸ”£ã§ ğŸ”£ãƒ)
    (d m l) (macro ğŸ”£ã¨ ğŸ”£ã…)
    (d j l) (macro ğŸ”£ã© ğŸ”£ã…)
    (e m p) (macro ğŸ”£ã¦ ğŸ”£ã‚…)
    (e j p) (macro ğŸ”£ã§ ğŸ”£ã‚…)
    (r m o) (macro ğŸ”£ã— ğŸ”£ã‡)
    (g m o) (macro ğŸ”£ã¡ ğŸ”£ã‡)
    (r j o) (macro ğŸ”£ã˜ ğŸ”£ã‡)
    (g j o) (macro ğŸ”£ã¢ ğŸ”£ã‡)

    (l k v) (macro ğŸ”£ã† ğŸ”£ãƒ)
    (l o v) (macro ğŸ”£ã† ğŸ”£ã‡)
    (l n v) (macro ğŸ”£ã† ğŸ”£ã‰)
    (k o v) (macro ğŸ”£ã„ ğŸ”£ã‡)
    (l j v) (macro ğŸ”£ã¤ ğŸ”£ã)
    (; j v) (macro ğŸ”£ãµ ğŸ”£ã)
    (; k v) (macro ğŸ”£ãµ ğŸ”£ãƒ)
    (; o v) (macro ğŸ”£ãµ ğŸ”£ã‡)
    (; n v) (macro ğŸ”£ãµ ğŸ”£ã‰)
    (; p v) (macro ğŸ”£ãµ ğŸ”£ã‚…)
    (h j v) (macro ğŸ”£ã ğŸ”£ã)
    (h k v) (macro ğŸ”£ã ğŸ”£ãƒ)
    (h o v) (macro ğŸ”£ã ğŸ”£ã‡)
    (h n v) (macro ğŸ”£ã ğŸ”£ã‰)
    (h . v) (macro ğŸ”£ã ğŸ”£ã‚)
    (h k f) (macro ğŸ”£ã ğŸ”£ã)
    (h l f) (macro ğŸ”£ã ğŸ”£ãƒ)
    (h o f) (macro ğŸ”£ã ğŸ”£ã‡)
    (h n f) (macro ğŸ”£ã ğŸ”£ã‰)
    (h . f) (macro ğŸ”£ã ğŸ”£ã‚)

    (j k) (layer-while-held symbol-1)
    (m ,) (layer-while-held symbol-2)
    (m k) (layer-while-held markdown)
    (d f) (layer-while-held edit-1)
    (c v) (layer-while-held edit-2)
    (v m) ret
)